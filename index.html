<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>VIAS - YOLO Vision</title>
<style>
body {margin:0;background:#050505;color:#dff;font-family:Segoe UI,sans-serif;overflow-x:hidden;}
h1{text-align:center;padding:25px 0;font-size:42px;color:#6ff;text-shadow:0 0 10px #0ff,0 0 20px #0ff;}
.container{width:100%;display:flex;padding:30px;box-sizing:border-box;justify-content:space-evenly;flex-wrap:wrap;}
.box{width:45%;min-width:350px;background:rgba(20,20,20,0.8);border-radius:15px;padding:15px;margin:20px 0;box-shadow:0 0 20px #0ff3;backdrop-filter:blur(10px);border:1px solid #0ff3;transition:0.25s ease;}
.box:hover{box-shadow:0 0 25px #0ff,0 0 40px #0ff7;transform:translateY(-5px);}
h2{text-align:center;font-size:24px;margin-bottom:10px;color:#9ff;text-shadow:0 0 8px #0ff;}
video,img{width:100%;border-radius:12px;border:1px solid #0ff5;box-shadow:0 0 15px #0ff4;}
.fps-tag{margin-top:10px;text-align:center;font-size:14px;color:#8f8;opacity:0.85;}
.loading{width:100px;height:100px;border-radius:50%;border:4px solid #0ff3;border-top-color:#0ff;animation:spin 1s linear infinite;margin:40px auto;display:none;}
@keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
</style>
</head>
<body>
<h1>VIAS - Visually Impaired Assistance System</h1>
<div class="container">
<div class="box">
<h2>ðŸ“¸ Local Camera</h2>
<video id="cam" autoplay playsinline></video>
<p class="fps-tag" id="fps_local">Local FPS: --</p>
</div>
<div class="box">
<h2>ðŸ¤– YOLO Processed</h2>
<img id="processed"/>
<div class="loading" id="loading"></div>
<p class="fps-tag" id="fps_yolo">YOLO FPS: --</p>
</div>
</div>
<script>
async function main(){
  const video=document.getElementById("cam");
  const processed=document.getElementById("processed");
  const load=document.getElementById("loading");
  const fpsLocal=document.getElementById("fps_local");
  const fpsYolo=document.getElementById("fps_yolo");
  const stream=await navigator.mediaDevices.getUserMedia({video:true});
  video.srcObject=stream;
  let lastLocal=performance.now();
  let lastYolo=performance.now();
  const ws=new WebSocket("ws://localhost:5000/ws");
  ws.onopen=()=>{load.style.display="none";}
  ws.onmessage=(event)=>{
    processed.src="data:image/jpeg;base64,"+event.data;
    let now=performance.now();
    let fps=(1000/(now-lastYolo)).toFixed(1);
    lastYolo=now;
    fpsYolo.textContent="YOLO FPS: "+fps;
  };
  const canvas=document.createElement("canvas");
  const ctx=canvas.getContext("2d");
  setInterval(()=>{
    canvas.width=video.videoWidth;
    canvas.height=video.videoHeight;
    ctx.drawImage(video,0,0);
    canvas.toBlob((blob)=>{
      if(!blob)return;
      if(ws.readyState===WebSocket.OPEN){
        blob.arrayBuffer().then((buf)=>ws.send(buf));
      }
    },"image/jpeg",0.7);
    let now=performance.now();
    let fps=(1000/(now-lastLocal)).toFixed(1);
    lastLocal=now;
    fpsLocal.textContent="Local FPS: "+fps;
  },120);
}
main();
</script>
</body>
</html>
